<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css">
    <link rel="stylesheet" href="/fontawesome/fontawesome-free-6.3.0-web/css/all.min.css">
    <link rel="stylesheet" href="/stylesheets/home.css">
    <title>Fnews</title>
    <style>
        .text {
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            text-overflow: ellipsis;
        }
    </style>
</head>

<body>
    <div class="position-relative w-100 h-100">
        <!-- Nav 1 -->
        <div class="container-fluid bg-light " style="z-index: 2;">
            <div class="container">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <div class="container-fluid d-flex align-items-center">
                        <a class="navbar-brand fw-bold" style="color: #ff6200;" href="/">FNEWS</a>
                        <div class="d-flex justify-content-start flex-grow-1 ms-4 me-2 border-start ps-3"
                            style="border-color: rgb(17, 17, 17);">
                            <p id="time">Thứ 7, 13/4/2023</p>
                            <div class="d-flex flex-grow-1 justify-content-end  me-5">
                                <a href="#" class="text-dark"><i class="far fa-clock me-1"></i>Mới nhất</a>
                                <a href="#" class="text-dark"><i class="fa-solid fa-location-dot me-1 ms-3"></i>Tin cơ
                                    sở</a>
                            </div>
                        </div>
                        <form class="d-flex">
                            <div class="input-group">
                                <div class="form">
                                    <input id="search-input" type="search" id="form1" class="form-control"
                                        placeholder="Tìm kiếm" />
                                </div>
                                <button id="search-button" type="button" class="btn btn-primary">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </form>
                        <div class="d-flex ms-4 position-relative " style="z-index: 2;">
                            <i class="fas fa-user mt-1"></i>
                            <a href="/login" class="ms-2 position-relative" style="display: block;" id="username">Đăng
                                nhập</a>
                            <div id="info-popup" class="d-flex flex-column"
                                style="position: absolute; left: 0; top: 110%;z-index: 2;background: #fff; width: 200px; box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2); visibility: hidden;">
                                <a href="/profile" class="my-2 px-2">Cá nhân</a>
                                <a style="cursor: pointer;" id="logout" class="my-2 px-2">Đăng xuất</a>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        <!-- Nav 2 -->
        <div class="container-fluid bg-light sticky-top" style="z-index: 1;">
            <div class="container bg-light h-50 pt-3 pb-3 align-content-center sticky-top" style="z-index: 1;">
                <ul class="d-flex" id="field-list"></ul>
            </div>
        </div>
        <!-- Content -->
        <div class="container d-flex flex-column mt-4 ps-0 pe-0">

            <div id="content" class="d-flex">
                <input type="hidden" id="news-id" value="<%=id%>">
                <div class="w-75 d-flex flex-column">
                    <div id="inform-state" style="display: none;">Bài viết này đã bị ẩn hoặc chưa được phê
                        duyệt</div>
                    <p id="news-title" class="fs-4 my-3 fw-bold"></p>
                    <div id="news-content"></div>
                    <div id="action" class="d-flex align-items-center mt-4">
                        <i class="fa-regular fa-share-from-square me-4" id="news-share-action"></i>
                        <i class="fa-regular fa-comment me-4" id="news-comment-action" onclick="commentAction()"></i>
                        <i class="fa-regular fa-bookmark me-4" id="news-saved-action"></i>
                    </div>
                    <div id="comment-part" class="mt-4">

                        <div id="comment-text-part" style="display: none;">
                            <label for="exampleFormControlInput1" class="form-label fw-bolder">Ý kiến</label>
                            <input type="text" class="form-control" id="exampleFormControlInput1"
                                placeholder="Nhập ý kiến của bạn...">
                            <button id="comment-sent">Gửi</button>
                        </div>
                        <div id="comment-list">

                        </div>
                    </div>
                </div>

                <div class="ps-3 w-25">
                    <div class="d-flex flex-column border-start border-1 ps-4 ms-3" style="border: #232323;">
                        <a href="#" class="fs-5 mb-4 fw-bolder"
                            style="font-family: 'Times New Roman', Times, serif; text-decoration: underline; color: rgb(255, 77, 0);">XEM
                            NHIỀU NHẤT</a>
                        <div id="high-view-news">

                        </div>
                        <a href="#" class="bg-light text-center p-2 ms-2 me-2 mb-4">Xem Thêm</a>

                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="d-flex flex-column mt-4 mb-4">
                <div class="w-100" style="height: 10px; background: #ececec;"></div>
                <div class="d-flex justify-content-between mt-4">
                    <div class="d-flex flex-column">
                        <a class="fw-bolder mb-1" href="#">Trang chủ</a>
                        <a class="fw-bolder mb-1" href="#">Video</a>
                    </div>
                    <div class="d-flex flex-column">
                        <a class="fw-bolder mb-1" href="#">Mới nhất</a>
                        <a class="fw-bolder mb-1" href="#">Xem nhiều</a>
                        <a class="fw-bolder mb-1" href="#">Tin nóng</a>
                    </div>
                    <div class="d-flex flex-column" id="field-footer">
                        <a class="fw-bolder mb-1" href="#">Tiêu điểm</a>
                        <a class="fw-bolder mb-1" href="#">Hoạt động</a>
                        <a class="fw-bolder mb-1" href="#">Cuộc thi</a>
                        <a class="fw-bolder mb-1" href="#">Tuyển sinh</a>
                        <a class="fw-bolder mb-1" href="#">Thể thao</a>
                        <a class="fw-bolder mb-1" href="#">Giao lưu</a>
                    </div>
                    <div class="d-flex flex-column w-25">
                        <p>Tải ứng dụng</p>
                        <a href="#" class="p-1 mt-2 mb-2"><i class="fa-solid fa-mobile me-2"></i>Fnews</a>
                        <p>Liên hệ chúng tôi</p>
                        <a href="#" class="p-1 mt-2 mb-2"><i class="fas fa-envelope me-2"></i>Tòa soạn</a>
                        <a href="#" class="p-1 mt-2 mb-2"><i class="fas fa-ad me-2"></i>Liên hệ quảng cáo</a>
                        <p>Đường dây nóng</p>
                        <p href="#" class="p-1 mt-2 mb-2"><i class="fas fa-phone me-2"></i>1900 8282</p>
                    </div>
                </div>
                <div class="d-flex justify-content-between align-items-center border-top mt-2 pt-2 pb-2"
                    style="border-color: #232323;">
                    <p>Báo điện tử:
                        <a class="navbar-brand fw-bold fs-6 m-0 p-0" style="color: rgb(254, 80, 6);" href="/"><span
                                class="navbar-brand fw-bold fs-4 m-0" style="color: rgb(254, 80, 6);">F</span>NEWS</a>
                    </p>
                    <p>Theo dõi chúng tôi trên: <i class="fa-brands fa-facebook ms-2 me-2"
                            style="color: #1842ff;"></i> <i class="fa-brands fa-youtube" style="color: red;"></i></p>
                </div>
                <div class="d-flex flex-row justify-content-between border-top pt-3" style="border-color: #232323;">
                    <div class="d-flex flex-column">
                        <p>Tổng biên tập: Phạm Hiếu</p>
                        <p>Địa chỉ: Tầng 10, Tòa A FPT Tower, số 10 Phạm Văn Bạch, Dịch Vọng, Cầu Giấy, Hà Nội</p>
                        <p>Điện thoại: 024 7300 8899 - máy lẻ 4500</p>
                    </div>
                    <p>© 1997-2023. Toàn bộ bản quyền thuộc Fnews</p>
                </div>
            </div>

        </div>
        <!-- up arow -->
        <a href="#" class="position-fixed p-2 border border-1 border-success"
            style="bottom: 30px; right: 30px; border-radius: 10%;">
            <i class="fa-solid fa-circle-up fa-square-up" style="color: green;"></i>
        </a>

    </div>

    <script src="/javascripts/jquery.js"></script>
    <script src="/bootstrap-5/js/bootstrap.min.js"></script>
    <script>

        function loadField() {
            $.ajax({
                url: '/field?active=true',
                dataType: 'json',
                type: 'GET',
                success: function (data) {
                    if (data.success) {
                        $('#field-list').empty()
                        $('#field-footer').empty()
                        currentField = data.data[0]._id
                        data.data.forEach(element => {
                            $('#field-list').append(
                                `<li>
                            <a href="/news-view/${element._id}">${element.value}</a>
                        </li>`
                            )

                            $('#field-footer').append(
                                `<a href="/news-view/${element._id} class="fw-bolder mb-3" style="font-weight: bold;">${element.value}</a>`
                            )
                        });
                    }
                },
            });
        }

        loadField()

        $.ajax({
            url: `/news/${$('#news-id').val()}`,
            type: 'GET',
            success: (data) => {
                if (data.success) {
                    if (data.data.state == 1 && data.data.active == true) {
                        $('#inform-state').hide()
                        $('#news-title').text(data.data.title)
                        $("#news-content").html(data.data.content)
                    } else {
                        $('#inform-state').show()
                        $('#news-title').text("")
                        $("#news-content").html("")
                    }
                } else {
                    console.log(data.message)
                }
            }
        })

        function loadHighViewNews() {
            $.ajax({
                url: '/news/get-high-view-news?limit=4',
                dataType: 'json',
                type: 'GET',
                success: function (data) {
                    if (data.success) {
                        $('#high-view-news').empty()
                        data.data.forEach(el => {
                            $('#high-view-news').append(
                                `<div href="#" class="d-flex pt-2 mb-3 me-2" style="width: 100%;">
                                    <div style="width: 45%;">
                                    <img style="object-fit: cover;" height="80px" width="100%" src="/${el.avatar}" />
                                </div>
                                <div style="width: 55%;" class="d-flex flex-column">
                                    <a href="/news-view/${el._id}" class="ms-3 fw-normal text"
                                    style="font-family: 'Times New Roman', Times, serif; -webkit-line-clamp: 3; line-clamp: 3;">
                                    ${el.title}
                                    </a>
                                </div>
                                </div>`
                            )
                        })
                    }
                },
            });
        }

        loadHighViewNews()

        function getCookie(name) {
            function escape(s) { return s.replace(/([.*+?\^$(){}|\[\]\/\\])/g, '\\$1'); }
            var match = document.cookie.match(RegExp('(?:^|;\\s*)' + escape(name) + '=([^;]*)'));
            return match ? match[1] : null;
        }

        function shareAction() {

        }

        function commentAction() {
            if (getCookie("Authorization")) {
                $('#comment-text-part').toggle()
            } else {
                window.location.assign = "/login"
            }
        }

        function sendComment(content) {
            $.ajax({
                
            })
        }



    </script>


</body>

</html>